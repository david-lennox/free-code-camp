var Row = React.createClass({
  render: function(){
    return <tr><td>{this.props.name}</td><td><img className="avatar" src={this.props.imgurl} /></td><td>{this.props.recent}</td><td>{this.props.total}</td></tr>
  }
});

var Leaderboard = React.createClass({
  getInitialState: function(){
    return {leaderboardRows: [], sortBy: 'total', reverseOrder: true}
  },
  getUsers: function(){
      //this.setState({leaderboardRows: getFakeData()});  // Use this to avoid API calls
    var self = this;
    $.getJSON("https://fcctop100.herokuapp.com/api/fccusers/top/recent", function(users){
      self.setState({leaderboardRows: users});
    });
  },
  componentWillMount: function(){
    this.getUsers();
  },
  
  sortByRecent: function(){
    if(this.state.sortBy === "recent") this.toggleReverse();
    else this.setState({sortBy: 'recent', reverseOrder: true});
  },
  
  sortByTotal: function(){
    if(this.state.sortBy === "total") this.toggleReverse();
    else this.setState({sortBy: 'total', reverseOrder: true});
  },
  
  toggleReverse: function(){this.setState({reverseOrder: this.state.reverseOrder === false})},
  
  render: function() {
    var sortBy = this.state.sortBy;
    var reverse = this.state.reverseOrder;
    var ordered = this.state.leaderboardRows.sort(function(user1, user2){
      if(sortBy === "total"){
        if(reverse) return user2.alltime - user1.alltime;
        else return user1.alltime - user2.alltime;
      }
      else {
        if(reverse) return user2.recent - user1.recent;
        else return user1.recent - user2.recent;
      }
    });
    var rows = ordered.map(function(user){
      return <Row name={user.username} imgurl={user.img} recent={user.recent} total={user.alltime} key={user.username} />
    });
    return (
      <div>
        <h1>Free Code Camp Leaderboard</h1>
        <table>
        <tbody>
          <tr>
            <th>User</th>
            <th>Picture</th>
            <th onClick={this.sortByRecent}>Pts last 30 days</th>
            <th onClick={this.sortByTotal}>Total Score</th>
          </tr>
          {rows}
          </tbody>
        </table>
      </div>
    );
  }
});

ReactDOM.render(
  <Leaderboard />,
  document.getElementById('content')
);


function getFakeData(){
    return [{"username":"ndburrus","img":"https://avatars.githubusercontent.com/u/15148847?v=3","alltime":779,"recent":398,"lastUpdate":"2016-07-20T01:42:56.997Z"},{"username":"sjames1958gm","img":"https://avatars.githubusercontent.com/u/4639625?v=3","alltime":1623,"recent":370,"lastUpdate":"2016-07-17T19:24:12.776Z"},{"username":"Chrono79","img":"https://avatars.githubusercontent.com/u/9571508?v=3","alltime":1242,"recent":357,"lastUpdate":"2016-07-16T20:22:35.887Z"},{"username":"Krish2704","img":"https://avatars.githubusercontent.com/u/16540354?v=3","alltime":388,"recent":347,"lastUpdate":"2016-07-16T20:26:10.336Z"},{"username":"BKinahan","img":"https://avatars.githubusercontent.com/u/15965601?v=3","alltime":1681,"recent":335,"lastUpdate":"2016-07-16T20:21:50.566Z"},{"username":"anthonygallina1","img":"https://avatars.githubusercontent.com/u/11003055?v=3","alltime":1966,"recent":288,"lastUpdate":"2016-07-17T20:43:33.382Z"},{"username":"moigithub","img":"https://avatars.githubusercontent.com/u/7305974?v=3","alltime":1359,"recent":270,"lastUpdate":"2016-07-16T20:21:20.423Z"},{"username":"Masd925","img":"https://avatars.githubusercontent.com/u/9335367?v=3","alltime":1819,"recent":252,"lastUpdate":"2016-07-16T20:21:50.565Z"},{"username":"IshtmeetSingh","img":"https://avatars.githubusercontent.com/u/18218486?v=3","alltime":306,"recent":232,"lastUpdate":"2016-07-16T20:26:31.786Z"},{"username":"dhcodes","img":"https://avatars.githubusercontent.com/u/7917512?v=3","alltime":881,"recent":213,"lastUpdate":"2016-07-12T18:46:19.901Z"},{"username":"khaduch","img":"https://avatars.githubusercontent.com/u/1930584?v=3","alltime":962,"recent":198,"lastUpdate":"2016-06-06T19:03:58.903Z"},{"username":"llamatarianism","img":"https://avatars.githubusercontent.com/u/18077556?v=3","alltime":458,"recent":195,"lastUpdate":"2016-06-06T21:48:51.950Z"},{"username":"Blauelf","img":"https://avatars.githubusercontent.com/u/5952026?v=3","alltime":1832,"recent":177,"lastUpdate":"2016-07-11T22:09:23.965Z"},{"username":"maz-net-au","img":"https://avatars.githubusercontent.com/u/9792899?v=3","alltime":309,"recent":165,"lastUpdate":"2016-06-06T20:55:09.196Z"},{"username":"diomed","img":"https://avatars.githubusercontent.com/u/72777?v=3","alltime":173,"recent":154,"lastUpdate":"2016-07-16T20:41:16.571Z"},{"username":"coffeebeanzz","img":"https://avatars.githubusercontent.com/u/19631203?v=3","alltime":375,"recent":149,"lastUpdate":"2016-07-16T20:39:00.052Z"},{"username":"Athaman","img":"https://avatars.githubusercontent.com/u/17151688?v=3","alltime":151,"recent":148,"lastUpdate":"2016-06-06T22:52:20.943Z"},{"username":"allanarmstrong","img":"https://avatars.githubusercontent.com/u/506160?v=3","alltime":835,"recent":142,"lastUpdate":"2016-07-01T02:50:45.138Z"},{"username":"revisualize","img":"https://avatars.githubusercontent.com/u/1588399?v=3","alltime":940,"recent":138,"lastUpdate":"2016-06-06T19:24:24.260Z"},{"username":"UtkarshShukla7","img":"https://avatars.githubusercontent.com/u/17803155?v=3","alltime":291,"recent":132,"lastUpdate":"2016-06-06T21:35:27.996Z"},{"username":"coymeetsworld","img":"https://avatars.githubusercontent.com/u/7891989?v=3","alltime":939,"recent":126,"lastUpdate":"2016-07-12T18:46:57.175Z"},{"username":"CEREBR4L","img":"https://avatars.githubusercontent.com/u/7153918?v=3","alltime":852,"recent":125,"lastUpdate":"2016-07-12T18:46:18.487Z"},{"username":"silver537","img":"https://avatars.githubusercontent.com/u/19628975?v=3","alltime":121,"recent":119,"lastUpdate":"2016-07-11T18:10:32.977Z"},{"username":"ashamishra","img":"https://avatars.githubusercontent.com/u/15140622?v=3","alltime":153,"recent":118,"lastUpdate":"2016-06-06T22:12:52.955Z"},{"username":"chuckadams","img":"https://avatars.githubusercontent.com/u/3925?v=3","alltime":676,"recent":116,"lastUpdate":"2016-07-16T20:22:05.671Z"},{"username":"Spatzerny","img":"https://avatars.githubusercontent.com/u/861575?v=3","alltime":622,"recent":115,"lastUpdate":"2016-06-09T21:51:18.992Z"},{"username":"GregatGit","img":"https://avatars.githubusercontent.com/u/14268453?v=3","alltime":257,"recent":113,"lastUpdate":"2016-06-06T18:58:13.007Z"},{"username":"ArielLeslie","img":"https://avatars.githubusercontent.com/u/6234475?v=3","alltime":1299,"recent":98,"lastUpdate":"2016-06-24T19:05:07.692Z"},{"username":"lx-t","img":"https://avatars.githubusercontent.com/u/18902468?v=3","alltime":138,"recent":96,"lastUpdate":"2016-07-11T13:53:17.719Z"},{"username":"iccomq","img":"https://avatars.githubusercontent.com/u/15857398?v=3","alltime":219,"recent":94,"lastUpdate":"2016-06-18T00:24:49.573Z"},{"username":"nugoose","img":"https://avatars.githubusercontent.com/u/14965989?v=3","alltime":357,"recent":87,"lastUpdate":"2016-06-06T18:37:39.583Z"},{"username":"wearenotgroot","img":"https://avatars.githubusercontent.com/u/16578279?v=3","alltime":904,"recent":83,"lastUpdate":"2016-07-12T18:45:43.726Z"},{"username":"mmacedoeu","img":"https://avatars.githubusercontent.com/u/4959023?v=3","alltime":290,"recent":83,"lastUpdate":"2016-06-06T19:03:58.902Z"},{"username":"nviser","img":"https://avatars.githubusercontent.com/u/15617423?v=3","alltime":272,"recent":81,"lastUpdate":"2016-06-06T19:05:14.126Z"},{"username":"sorinr","img":"https://avatars.githubusercontent.com/u/8637239?v=3","alltime":111,"recent":81,"lastUpdate":"2016-06-24T19:25:56.563Z"},{"username":"JasonDeving","img":"https://avatars.githubusercontent.com/u/11493917?v=3","alltime":197,"recent":78,"lastUpdate":"2016-06-06T18:51:56.817Z"},{"username":"codemzy","img":"https://avatars.githubusercontent.com/u/13764272?v=3","alltime":779,"recent":77,"lastUpdate":"2016-07-16T20:21:35.477Z"},{"username":"raavin","img":"https://avatars.githubusercontent.com/u/10605?v=3","alltime":148,"recent":77,"lastUpdate":"2016-07-12T07:01:14.728Z"},{"username":"profoundhub","img":"https://avatars.githubusercontent.com/u/8409825?v=3","alltime":356,"recent":76,"lastUpdate":"2016-07-16T20:24:21.684Z"},{"username":"jondcoleman","img":"https://avatars.githubusercontent.com/u/11843663?v=3","alltime":760,"recent":69,"lastUpdate":"2016-07-16T20:21:35.474Z"},{"username":"mdebruijne","img":"https://avatars.githubusercontent.com/u/11375308?v=3","alltime":46,"recent":68,"lastUpdate":"2016-06-15T18:02:25.357Z"},{"username":"TylerMoeller","img":"https://avatars.githubusercontent.com/u/12537021?v=3","alltime":246,"recent":64,"lastUpdate":"2016-06-06T18:58:13.010Z"},{"username":"kevcomedia","img":"https://avatars.githubusercontent.com/u/17902987?v=3","alltime":112,"recent":64,"lastUpdate":"2016-07-11T18:06:45.280Z"},{"username":"mutantspore","img":"https://avatars.githubusercontent.com/u/13058496?v=3","alltime":1357,"recent":59,"lastUpdate":"2016-07-01T02:50:49.446Z"},{"username":"wordyallen","img":"https://avatars.githubusercontent.com/u/4591833?v=3","alltime":224,"recent":59,"lastUpdate":"2016-06-06T19:22:08.593Z"},{"username":"pwatrous","img":"https://avatars.githubusercontent.com/u/10429595?v=3","alltime":72,"recent":59,"lastUpdate":"2016-06-28T20:30:35.245Z"},{"username":"jedpimentel","img":"https://avatars.githubusercontent.com/u/6427690?v=3","alltime":728,"recent":58,"lastUpdate":"2016-06-24T19:03:59.406Z"},{"username":"uniforlyff","img":"https://avatars.githubusercontent.com/u/16857173?v=3","alltime":107,"recent":58,"lastUpdate":"2016-07-16T20:42:17.238Z"},{"username":"JohnTendik","img":"https://avatars.githubusercontent.com/u/4714913?v=3","alltime":143,"recent":58,"lastUpdate":"2016-07-12T02:35:21.450Z"},{"username":"dmk11","img":"https://avatars.githubusercontent.com/u/17209738?v=3","alltime":130,"recent":56,"lastUpdate":"2016-07-11T17:50:51.053Z"},{"username":"astrimbu","img":"https://avatars.githubusercontent.com/u/1097487?v=3","alltime":3,"recent":54,"lastUpdate":"2016-06-07T01:47:35.765Z"},{"username":"cannelflow","img":"https://avatars.githubusercontent.com/u/12219251?v=3","alltime":884,"recent":53,"lastUpdate":"2016-06-06T19:03:13.777Z"},{"username":"alayek","img":"https://avatars.githubusercontent.com/u/5607371?v=3","alltime":602,"recent":52,"lastUpdate":"2016-06-06T18:58:58.118Z"},{"username":"sid7","img":"https://avatars.githubusercontent.com/u/9059446?v=3","alltime":106,"recent":52,"lastUpdate":"2016-06-06T19:12:31.384Z"},{"username":"tadake","img":"https://avatars.githubusercontent.com/u/16967312?v=3","alltime":122,"recent":52,"lastUpdate":"2016-06-28T20:17:57.321Z"},{"username":"peteczz","img":"https://avatars.githubusercontent.com/u/13965406?v=3","alltime":57,"recent":52,"lastUpdate":"2016-06-24T05:34:14.467Z"},{"username":"vihaan7122014","img":"https://avatars.githubusercontent.com/u/17779028?v=3","alltime":60,"recent":51,"lastUpdate":"2016-06-06T20:57:10.153Z"},{"username":"Adam-Lowee","img":"https://avatars.githubusercontent.com/u/18180966?v=3","alltime":51,"recent":51,"lastUpdate":"2016-04-16T21:15:00.385Z"},{"username":"Maestra12","img":"https://avatars.githubusercontent.com/u/19158467?v=3","alltime":46,"recent":51,"lastUpdate":"2016-06-24T19:29:13.721Z"},{"username":"bitgrower","img":"https://avatars.githubusercontent.com/u/16696049?v=3","alltime":780,"recent":50,"lastUpdate":"2016-06-06T18:35:39.409Z"},{"username":"ducthanh512","img":"https://avatars.githubusercontent.com/u/17810713?v=3","alltime":50,"recent":50,"lastUpdate":"2016-04-23T15:07:57.547Z"},{"username":"alexanderkopke","img":"https://avatars.githubusercontent.com/u/13712290?v=3","alltime":361,"recent":49,"lastUpdate":"2016-06-06T19:06:44.387Z"},{"username":"cswl","img":"https://avatars.githubusercontent.com/u/12976647?v=3","alltime":49,"recent":49,"lastUpdate":"2016-07-16T20:43:17.903Z"},{"username":"Rafase282","img":"https://avatars.githubusercontent.com/u/285138?v=3","alltime":936,"recent":48,"lastUpdate":"2016-07-01T02:50:44.622Z"},{"username":"moser13a","img":"https://avatars.githubusercontent.com/u/17257662?v=3","alltime":102,"recent":47,"lastUpdate":"2016-06-06T20:02:26.025Z"},{"username":"overmelo","img":"https://avatars.githubusercontent.com/u/17744075?v=3","alltime":62,"recent":47,"lastUpdate":"2016-06-06T20:51:52.245Z"},{"username":"LMApro","img":"https://avatars.githubusercontent.com/u/4292075?v=3","alltime":49,"recent":47,"lastUpdate":"2016-06-15T18:08:31.717Z"},{"username":"RainbowDangerDash","img":"https://avatars.githubusercontent.com/u/2415206?v=3","alltime":46,"recent":46,"lastUpdate":"2016-06-02T21:09:15.364Z"},{"username":"bumbeishvili","img":"https://avatars.githubusercontent.com/u/6873202?v=3","alltime":54,"recent":45,"lastUpdate":"2016-06-06T18:34:54.330Z"},{"username":"qualitymanifest","img":"https://avatars.githubusercontent.com/u/13897419?v=3","alltime":900,"recent":45,"lastUpdate":"2016-06-24T19:03:35.813Z"},{"username":"etacalpha","img":"https://avatars.githubusercontent.com/u/18453591?v=3","alltime":48,"recent":45,"lastUpdate":"2016-06-06T22:47:48.646Z"},{"username":"Sloooop","img":"https://avatars.githubusercontent.com/u/11283179?v=3","alltime":46,"recent":45,"lastUpdate":"2016-06-07T00:20:03.510Z"},{"username":"gottalovelattes","img":"https://avatars.githubusercontent.com/u/16947847?v=3","alltime":51,"recent":45,"lastUpdate":"2016-06-24T19:29:59.169Z"},{"username":"Gmunker","img":"https://avatars.githubusercontent.com/u/10760697?v=3","alltime":55,"recent":45,"lastUpdate":"2016-07-11T18:04:13.603Z"},{"username":"dincel","img":"https://avatars.githubusercontent.com/u/12811110?v=3","alltime":56,"recent":44,"lastUpdate":"2016-06-06T18:36:54.515Z"},{"username":"AungMyoKyaw","img":"https://avatars.githubusercontent.com/u/9404824?v=3","alltime":54,"recent":44,"lastUpdate":"2016-06-06T18:38:39.667Z"},{"username":"joseluiscc","img":"https://avatars.githubusercontent.com/u/5056623?v=3","alltime":72,"recent":44,"lastUpdate":"2016-06-06T18:50:56.697Z"},{"username":"Thiggs","img":"https://avatars.githubusercontent.com/u/17105367?v=3","alltime":53,"recent":44,"lastUpdate":"2016-06-06T19:42:44.827Z"},{"username":"knopki","img":"https://avatars.githubusercontent.com/u/891832?v=3","alltime":53,"recent":44,"lastUpdate":"2016-06-06T19:46:46.390Z"},{"username":"wubr","img":"https://avatars.githubusercontent.com/u/763469?v=3","alltime":53,"recent":44,"lastUpdate":"2016-06-06T20:00:09.420Z"},{"username":"hozzj","img":"https://avatars.githubusercontent.com/u/13457698?v=3","alltime":54,"recent":44,"lastUpdate":"2016-06-06T20:03:11.285Z"},{"username":"jbelezina","img":"https://avatars.githubusercontent.com/u/9052138?v=3","alltime":53,"recent":44,"lastUpdate":"2016-06-06T20:15:31.922Z"},{"username":"chandanac","img":"https://avatars.githubusercontent.com/u/1854547?v=3","alltime":53,"recent":44,"lastUpdate":"2016-06-06T20:49:19.918Z"},{"username":"pcrubianoa","img":"https://avatars.githubusercontent.com/u/7673724?v=3","alltime":52,"recent":44,"lastUpdate":"2016-06-24T18:49:50.639Z"},{"username":"MikeLDJ","img":"https://avatars.githubusercontent.com/u/15210388?v=3","alltime":53,"recent":44,"lastUpdate":"2016-06-06T20:52:37.678Z"},{"username":"deniskasyanov","img":"https://avatars.githubusercontent.com/u/2562680?v=3","alltime":53,"recent":44,"lastUpdate":"2016-06-15T17:52:59.767Z"},{"username":"gt50","img":"https://avatars.githubusercontent.com/u/4196429?v=3","alltime":91,"recent":44,"lastUpdate":"2016-06-06T21:16:49.005Z"},{"username":"rgavs","img":"https://avatars.githubusercontent.com/u/6393362?v=3","alltime":53,"recent":44,"lastUpdate":"2016-06-06T21:27:23.888Z"},{"username":"SeanCox","img":"https://avatars.githubusercontent.com/u/16828825?v=3","alltime":53,"recent":44,"lastUpdate":"2016-06-06T21:41:02.261Z"},{"username":"votrex","img":"https://avatars.githubusercontent.com/u/8436660?v=3","alltime":53,"recent":44,"lastUpdate":"2016-06-28T20:18:27.544Z"},{"username":"costik84","img":"https://avatars.githubusercontent.com/u/18103740?v=3","alltime":54,"recent":44,"lastUpdate":"2016-06-06T21:55:10.170Z"},{"username":"Her0Zer0","img":"https://avatars.githubusercontent.com/u/18375525?v=3","alltime":53,"recent":44,"lastUpdate":"2016-06-06T22:27:51.243Z"},{"username":"PabbaShivaRamKaushil","img":"https://avatars.githubusercontent.com/u/18499911?v=3","alltime":43,"recent":44,"lastUpdate":"2016-07-16T20:24:36.819Z"},{"username":"dhjc","img":"https://avatars.githubusercontent.com/u/18750290?v=3","alltime":47,"recent":44,"lastUpdate":"2016-06-28T20:20:13.507Z"},{"username":"R-HirojaTrevize","img":"https://avatars.githubusercontent.com/u/8755094?v=3","alltime":45,"recent":44,"lastUpdate":"2016-06-07T00:28:53.336Z"},{"username":"rom81","img":"https://avatars.githubusercontent.com/u/14862654?v=3","alltime":55,"recent":44,"lastUpdate":"2016-06-07T02:32:33.472Z"},{"username":"KasiaBM","img":"https://avatars.githubusercontent.com/u/6464664?v=3","alltime":45,"recent":44,"lastUpdate":"2016-06-24T19:28:43.423Z"},{"username":"corneal64","img":"https://avatars.githubusercontent.com/u/13474817?v=3","alltime":47,"recent":44,"lastUpdate":"2016-07-11T18:02:57.804Z"},{"username":"daz1uk","img":"https://avatars.githubusercontent.com/u/7613786?v=3","alltime":45,"recent":44,"lastUpdate":"2016-07-16T20:35:12.803Z"},{"username":"JaminEwell","img":"https://avatars.githubusercontent.com/u/14047551?v=3","alltime":54,"recent":44,"lastUpdate":"2016-06-07T06:38:13.108Z"}]
}